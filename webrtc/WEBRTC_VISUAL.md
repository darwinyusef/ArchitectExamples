# ğŸ¨ WebRTC - GuÃ­a Visual

Diagramas y visualizaciones para entender WebRTC fÃ¡cilmente.

---

## ğŸŒŠ Flujo Completo de ConexiÃ³n WebRTC

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PROCESO DE CONEXIÃ“N WEBRTC                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PEER A (Alice)          SERVIDOR SEÃ‘ALIZACIÃ“N           PEER B (Bob)
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚                            â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚Browser â”‚                  â”‚WebSocketâ”‚                  â”‚Browser â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ Server â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚                            â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€ 1. CONECTAR â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚â—„â”€â”€â”€â”€â”€â”€ 1. CONECTAR â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚        WebSocket           â”‚        WebSocket           â”‚
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚                            â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
â”‚  2. ALICE INICIA LLAMADA                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚                            â”‚
    â”‚  getUserMedia()            â”‚                            â”‚
    â”‚  (cÃ¡mara/micro)            â”‚                            â”‚
    â”‚                            â”‚                            â”‚
    â”‚  createOffer()             â”‚                            â”‚
    â”‚  setLocalDescription()     â”‚                            â”‚
    â”‚                            â”‚                            â”‚
    â”‚â”€â”€â”€â”€ OFFER (SDP) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                            â”‚
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚â”€â”€â”€â”€ OFFER (SDP) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                            â”‚                            â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
â”‚  3. BOB RESPONDE                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚         getUserMedia()     â”‚
    â”‚                            â”‚         (cÃ¡mara/micro)     â”‚
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚    setRemoteDescription()  â”‚
    â”‚                            â”‚    createAnswer()          â”‚
    â”‚                            â”‚    setLocalDescription()   â”‚
    â”‚                            â”‚                            â”‚
    â”‚                            â”‚â—„â”€â”€â”€â”€ ANSWER (SDP) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                            â”‚                            â”‚
    â”‚â—„â”€â”€â”€â”€ ANSWER (SDP) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
    â”‚                            â”‚                            â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
â”‚  4. INTERCAMBIO ICE CANDIDATES (Descubrimiento de Red)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚                            â”‚
    â”‚â”€â”€â”€â”€ ICE Candidate 1 â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€ ICE Candidate 1 â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                            â”‚                            â”‚
    â”‚â—„â”€â”€â”€ ICE Candidate 1 â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€ ICE Candidate 1 â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                            â”‚                            â”‚
    â”‚â”€â”€â”€â”€ ICE Candidate 2 â”€â”€â”€â”€â”€â”€â–ºâ”‚â”€â”€â”€â”€ ICE Candidate 2 â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                            â”‚                            â”‚
    â”‚â—„â”€â”€â”€ ICE Candidate 2 â”€â”€â”€â”€â”€â”€â”€â”‚â—„â”€â”€â”€ ICE Candidate 2 â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                            â”‚                            â”‚
    â”‚        ... mÃ¡s ...         â”‚        ... mÃ¡s ...         â”‚
    â”‚                            â”‚                            â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
â”‚  5. CONEXIÃ“N P2P ESTABLECIDA (Ya no necesita servidor!)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                            â”‚                            â”‚
    â”‚                            â”¼                            â”‚
    â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
    â”‚        AUDIO/VIDEO         â•¬        AUDIO/VIDEO         â”‚
    â”‚         (DIRECTO)          â•¬         (DIRECTO)          â”‚
    â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
    â”‚                            â•¬                            â”‚
    â”‚         Data Channel       â•¬       Data Channel         â”‚
    â”‚        (chat, files)       â•¬      (chat, files)         â”‚
    â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
    â”‚                            â”‚                            â”‚
    â–¼                            â–¼                            â–¼
```

---

## ğŸ  Tipos de ConexiÃ³n NAT

### Escenario 1: Misma Red Local (FÃ¡cil)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          RED LOCAL                  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Alice    â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Bob      â”‚   â”‚
â”‚  â”‚192.168.1.â”‚      â”‚192.168.1.â”‚   â”‚
â”‚  â”‚    10    â”‚      â”‚    20    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  âœ… ConexiÃ³n directa (host)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Escenario 2: Redes Diferentes con STUN (70% casos)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Casa de Alice  â”‚         â”‚   Casa de Bob    â”‚
â”‚                  â”‚         â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Alice    â”‚   â”‚         â”‚  â”‚ Bob      â”‚    â”‚
â”‚  â”‚192.168.1.â”‚   â”‚         â”‚  â”‚192.168.1.â”‚    â”‚
â”‚  â”‚    10    â”‚   â”‚         â”‚  â”‚    50    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚         â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚        â”‚         â”‚        â”‚         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Router   â”‚ â”‚         â”‚ â”‚   Router   â”‚   â”‚
â”‚  â”‚ Firewall   â”‚ â”‚         â”‚ â”‚ Firewall   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
         â”‚ IP: 203.0.113.45         â”‚ IP: 198.51.100.22
         â”‚                           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
              â”‚ STUN Server â”‚
              â”‚  (Google)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚
    "Tu IP es            "Tu IP es
  203.0.113.45"         198.51.100.22"
         â”‚                       â”‚
         â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
         â”‚   ConexiÃ³n Directa    â”‚
         â”‚   (Server Reflexive)  â”‚
         â”‚                       â”‚
```

### Escenario 3: Firewall Estricto - Necesita TURN (30% casos)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Casa de Alice  â”‚         â”‚  Oficina de Bob  â”‚
â”‚                  â”‚         â”‚  (Firewall Corp) â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Alice    â”‚   â”‚         â”‚  â”‚ Bob      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚         â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚        â”‚         â”‚        â”‚         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Router    â”‚ â”‚         â”‚ â”‚ Firewall   â”‚   â”‚
â”‚  â”‚            â”‚ â”‚         â”‚ â”‚  Estricto  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
         â”‚                           â”‚
         â”‚                           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚  âŒ No pueden conectar directo
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   TURN Server     â”‚
         â”‚   (Relay)         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ Alice   â”‚         â”‚  Bob    â”‚
    â”‚ conecta â”‚         â”‚ conecta â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚
         â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
         â”‚  TURN retransmite â”‚
         â”‚    los datos      â”‚
```

---

## ğŸ“¦ Contenido del SDP (Session Description Protocol)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SDP OFFER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ v=0                          â† VersiÃ³n                  â”‚
â”‚ o=- 123456 2 IN IP4 0.0.0.0  â† Origen                  â”‚
â”‚ s=-                          â† Nombre sesiÃ³n            â”‚
â”‚ t=0 0                        â† Timing                   â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ AUDIO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ m=audio 9 UDP/TLS/RTP/SAVPF 111 103 104            â”‚ â”‚
â”‚ â”‚ c=IN IP4 0.0.0.0                                   â”‚ â”‚
â”‚ â”‚ a=rtpmap:111 opus/48000/2    â† Codec Opus          â”‚ â”‚
â”‚ â”‚ a=rtpmap:103 ISAC/16000      â† Codec ISAC          â”‚ â”‚
â”‚ â”‚ a=fmtp:111 minptime=10       â† ParÃ¡metros          â”‚ â”‚
â”‚ â”‚ a=ssrc:12345678 cname:alice  â† Identificador       â”‚ â”‚
â”‚ â”‚ a=ice-ufrag:abcd             â† ICE username        â”‚ â”‚
â”‚ â”‚ a=ice-pwd:1234567890         â† ICE password        â”‚ â”‚
â”‚ â”‚ a=fingerprint:sha-256 XX:XX  â† Certificado DTLS   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ VIDEO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ m=video 9 UDP/TLS/RTP/SAVPF 96 97 98               â”‚ â”‚
â”‚ â”‚ c=IN IP4 0.0.0.0                                   â”‚ â”‚
â”‚ â”‚ a=rtpmap:96 VP8/90000        â† Codec VP8           â”‚ â”‚
â”‚ â”‚ a=rtpmap:97 H264/90000       â† Codec H264          â”‚ â”‚
â”‚ â”‚ a=rtcp-fb:96 nack            â† Soporte NACK        â”‚ â”‚
â”‚ â”‚ a=rtcp-fb:96 ccm fir         â† Full Intra Request â”‚ â”‚
â”‚ â”‚ a=ssrc:87654321 cname:alice                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€ DATA CHANNEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ m=application 9 UDP/DTLS/SCTP webrtc-datachannel  â”‚ â”‚
â”‚ â”‚ a=sctp-port:5000             â† Puerto SCTP         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ Roles en la NegociaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            NEGOCIACIÃ“N OFFER/ANSWER                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PEER A (Initiator)              PEER B (Answerer)
      â”‚                                 â”‚
      â”‚  createOffer()                  â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
      â”‚  â”‚ CÃ³decs soportados:â”‚          â”‚
      â”‚  â”‚ - Opus (audio)    â”‚          â”‚
      â”‚  â”‚ - VP8 (video)     â”‚          â”‚
      â”‚  â”‚ - H264 (video)    â”‚          â”‚
      â”‚  â”‚ Resoluciones:     â”‚          â”‚
      â”‚  â”‚ - 1920x1080       â”‚          â”‚
      â”‚  â”‚ - 1280x720        â”‚          â”‚
      â”‚  â”‚ - 640x480         â”‚          â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
      â”‚           â”‚                     â”‚
      â”‚  setLocalDescription(offer)     â”‚
      â”‚           â”‚                     â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚       OFFER (SDP)               â”‚
      â”‚                                 â”‚
      â”‚                   setRemoteDescription(offer)
      â”‚                                 â”‚
      â”‚                   createAnswer()â”‚
      â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                   â”‚ IntersecciÃ³n:        â”‚
      â”‚                   â”‚ - Opus âœ…            â”‚
      â”‚                   â”‚ - VP8 âœ…             â”‚
      â”‚                   â”‚ - H264 âœ…            â”‚
      â”‚                   â”‚ ResoluciÃ³n elegida:  â”‚
      â”‚                   â”‚ - 1280x720 âœ…        â”‚
      â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                 â”‚
      â”‚                   setLocalDescription(answer)
      â”‚                                 â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
      â”‚       ANSWER (SDP)              â”‚
      â”‚                                 â”‚
      â”‚  setRemoteDescription(answer)   â”‚
      â”‚                                 â”‚
      â”‚      âœ… NEGOCIACIÃ“N COMPLETA    â”‚
      â”‚                                 â”‚
```

---

## ğŸ§Š ICE Candidate Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            TIPOS DE ICE CANDIDATES                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£  HOST (IP Local - Prioridad Alta)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ candidate: "host"                    â”‚
    â”‚ IP: 192.168.1.10                     â”‚
    â”‚ Port: 54321                          â”‚
    â”‚ Protocol: UDP                        â”‚
    â”‚ Priority: 2122260223 (MUY ALTA)      â”‚
    â”‚                                      â”‚
    â”‚ âœ… Funciona si: Misma red local      â”‚
    â”‚ âŒ No funciona: Internet             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2ï¸âƒ£  SERVER REFLEXIVE (IP PÃºblica vÃ­a STUN - Prioridad Media)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ candidate: "srflx"                   â”‚
    â”‚ IP: 203.0.113.45 (IP PÃšBLICA)        â”‚
    â”‚ Port: 12345                          â”‚
    â”‚ Protocol: UDP                        â”‚
    â”‚ Priority: 1686052607 (MEDIA)         â”‚
    â”‚ Related: 192.168.1.10:54321          â”‚
    â”‚                                      â”‚
    â”‚ âœ… Funciona: ~70% de casos           â”‚
    â”‚ âŒ No funciona: Firewall simÃ©trico   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ï¸âƒ£  RELAY (Via TURN Server - Prioridad Baja)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ candidate: "relay"                   â”‚
    â”‚ IP: turn.example.com                 â”‚
    â”‚ Port: 3478                           â”‚
    â”‚ Protocol: UDP/TCP/TLS                â”‚
    â”‚ Priority: 16777215 (BAJA)            â”‚
    â”‚                                      â”‚
    â”‚ âœ… Funciona: SIEMPRE (100%)          â”‚
    â”‚ âŒ Costo: Consume ancho de banda     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4ï¸âƒ£  PEER REFLEXIVE (Descubierto durante checks)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ candidate: "prflx"                   â”‚
    â”‚ IP: 198.51.100.22                    â”‚
    â”‚ Port: 65432                          â”‚
    â”‚ Protocol: UDP                        â”‚
    â”‚ Priority: 1845501695                 â”‚
    â”‚                                      â”‚
    â”‚ â„¹ï¸  Raro, solo en configuraciones    â”‚
    â”‚    especiales de NAT                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Capas de Seguridad

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        STACK DE SEGURIDAD WEBRTC                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        APLICACIÃ“N
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  JavaScript    â”‚
    â”‚   (tu cÃ³digo)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ WebRTC API     â”‚
    â”‚ (navegador)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SRTP (Audio/Video)   â”‚  â† Cifrado de medios
â”‚   AES-128 GCM          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DTLS (Handshake)     â”‚  â† Intercambio de claves
â”‚   TLS 1.2 / 1.3        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ICE (Conectividad)   â”‚  â† Descubrimiento de red
â”‚   STUN/TURN            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UDP / TCP            â”‚  â† Transporte
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”’ GARANTÃAS:
   âœ… Confidencialidad (cifrado)
   âœ… Integridad (no modificado)
   âœ… AutenticaciÃ³n (verificas identidad)
   âœ… Perfect Forward Secrecy (sesiones independientes)
```

---

## ğŸ“Š Estados de la ConexiÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ESTADOS DE RTCPeerConnection               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

connectionState:
    NEW
     â”‚
     â–¼
  CONNECTING  â†â”€â”€â”
     â”‚          â”‚
     â–¼          â”‚ (retry)
  CONNECTED     â”‚
     â”‚          â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
  DISCONNECTED â†â”€â” (temporal)
     â”‚          â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
    FAILED â”€â”€â”€â”€â”€â”€â”€â”€â–º CLOSED
     â”‚                  â–²
     â”‚                  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

iceConnectionState:
    NEW
     â”‚
     â–¼
   CHECKING (probando candidatos)
     â”‚
     â–¼
  CONNECTED (al menos 1 par funciona)
     â”‚
     â–¼
  COMPLETED (todos los checks terminaron)
     â”‚
     â–¼
  DISCONNECTED (temporal)
     â”‚
     â”œâ”€â”€â–º CHECKING (retry)
     â”‚
     â–¼
   FAILED â”€â”€â”€â”€â”€â”€â”€â”€â–º CLOSED

iceGatheringState:
    NEW
     â”‚
     â–¼
  GATHERING (recolectando candidatos)
     â”‚
     â–¼
  COMPLETE (todos los candidatos listos)
```

---

## ğŸ¬ Data Channel - Flujo de Datos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ENVÃO DE MENSAJE POR DATA CHANNEL         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PEER A                                    PEER B
   â”‚                                         â”‚
   â”‚ dataChannel.send("Hola")               â”‚
   â”‚         â”‚                               â”‚
   â–¼         â–¼                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚ Buffer Interno   â”‚                        â”‚
â”‚ (cola de envÃ­o)  â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
         â”‚                                  â”‚
         â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚ SCTP Protocol    â”‚                        â”‚
â”‚ (fragmentaciÃ³n)  â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
         â”‚                                  â”‚
         â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚ DTLS (cifrado)   â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
         â”‚                                  â”‚
         â–¼                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚ UDP/ICE          â”‚                        â”‚
â”‚ (transporte)     â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
         â”‚                                  â”‚
         â”‚â•â•â•â•â•â•â•â• INTERNET â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
         â”‚                                  â”‚
         â”‚                                  â–¼
         â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                        â”‚ UDP/ICE recibe   â”‚
         â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
         â”‚                                 â–¼
         â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                        â”‚ DTLS descifra    â”‚
         â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
         â”‚                                 â–¼
         â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                        â”‚ SCTP reensambla  â”‚
         â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
         â”‚                                 â–¼
         â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                        â”‚ Buffer Interno   â”‚
         â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
         â”‚                                 â–¼
         â”‚                        dataChannel.onmessage
         â”‚                                 â”‚
         â”‚                        Recibe: "Hola"
```

---

## ğŸŒ TopologÃ­as de Conferencia

### MESH (P2P completo)

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Peer  â”‚
        â”‚   A   â”‚
        â””â”€â”€â”€â”¬â”€â”€â”€â”˜
           â•± â•²
          â•±   â•²
         â•±     â•²
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ Peer  â”‚ â”‚ Peer  â”‚
    â”‚   B   â”‚ â”‚   C   â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”¬â”€â”€â”€â”€â”€â”˜
        â•²     â•±
         â•²   â•±
          â•² â•±
        â”Œâ”€â”€â–¼â”€â”€â”
        â”‚Peer â”‚
        â”‚  D  â”‚
        â””â”€â”€â”€â”€â”€â”˜

Conexiones: n(n-1)/2
4 personas = 6 conexiones
10 personas = 45 conexiones

âœ… Baja latencia
âŒ No escala (consume mucho)
```

### SFU (Selective Forwarding Unit)

```
â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚Peer Aâ”‚  â”‚Peer Bâ”‚  â”‚Peer Câ”‚
â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚         â”‚         â”‚
   â””â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”˜
        â”‚    â”‚    â”‚
      â”Œâ”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”
      â”‚     SFU     â”‚
      â”‚   Server    â”‚
      â””â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”˜
        â”‚    â”‚    â”‚
   â”Œâ”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”
   â”‚         â”‚         â”‚
â”Œâ”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”
â”‚Peer Aâ”‚  â”‚Peer Bâ”‚  â”‚Peer Câ”‚
â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜

Cada peer envÃ­a 1 stream
Recibe N-1 streams

âœ… Escala bien (lineal)
âœ… Latencia baja
âš–ï¸  Requiere servidor
```

### MCU (Multipoint Control Unit)

```
â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚Peer Aâ”‚  â”‚Peer Bâ”‚  â”‚Peer Câ”‚
â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
   â”‚         â”‚         â”‚
   â””â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”˜
        â”‚    â”‚    â”‚
      â”Œâ”€â–¼â”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”€â”
      â”‚     MCU     â”‚
      â”‚  Decodifica â”‚
      â”‚  + Mezcla   â”‚
      â”‚  + Recodif. â”‚
      â””â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”˜
        â”‚    â”‚    â”‚
   Stream  Stream  Stream
   mixto   mixto   mixto
   â”Œâ”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”
   â”‚         â”‚         â”‚
â”Œâ”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”
â”‚Peer Aâ”‚  â”‚Peer Bâ”‚  â”‚Peer Câ”‚
â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜

Cada peer envÃ­a 1 stream
Recibe 1 stream mixto

âœ… Ancho de banda constante
âŒ Latencia alta (procesamiento)
âŒ Caro (CPU intensivo)
```

---

## ğŸ¯ Resumen Visual

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         COMPONENTES CLAVE DE WEBRTC             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. getUserMedia()      â†’ ğŸ¥ Acceso a cÃ¡mara/micro
2. RTCPeerConnection   â†’ ğŸ”— ConexiÃ³n P2P
3. RTCDataChannel      â†’ ğŸ’¬ EnvÃ­o de datos
4. Signaling Server    â†’ ğŸ“¡ WebSocket (offer/answer)
5. STUN Server         â†’ ğŸ—ºï¸  Descubre IP pÃºblica
6. TURN Server         â†’ ğŸ”„ Relay cuando STUN falla

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FLUJO SIMPLIFICADO                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Conectar a servidor de seÃ±alizaciÃ³n (WebSocket)
2. Crear offer (SDP con cÃ³decs y configuraciÃ³n)
3. Enviar offer al otro peer
4. Recibir answer del otro peer
5. Intercambiar ICE candidates (descubrir red)
6. Â¡ConexiÃ³n P2P establecida! ğŸ‰
7. Enviar/recibir audio/video/datos directamente

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                TECNOLOGÃAS                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WebRTC = WebSocket + STUN + TURN + DTLS + SRTP + ICE

ğŸ” Siempre cifrado (no opcional)
âš¡ Latencia ultra-baja (10-50ms)
ğŸŒ Funciona en todo el mundo
ğŸ†“ Gratis (excepto TURN)
```

---

**Con estos diagramas visuales es mucho mÃ¡s fÃ¡cil entender WebRTC!** ğŸ¨
